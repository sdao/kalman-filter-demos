(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     47216,       1319]
NotebookOptionsPosition[     44908,       1235]
NotebookOutlinePosition[     45264,       1251]
CellTagsIndexPosition[     45221,       1248]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"TrueVoltage", " ", "=", " ", "3.0"}]], "Input",
 CellChangeTimes->{{3.608763046220376*^9, 3.608763053601519*^9}, {
  3.608763367884221*^9, 3.608763369572784*^9}}],

Cell[BoxData["3.`"], "Output",
 CellChangeTimes->{3.608763060457548*^9, 3.6087633698898973`*^9, 
  3.608765193460161*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NoiseLevel", "=", "0.2"}]], "Input",
 CellChangeTimes->{{3.60876307157374*^9, 3.608763089029872*^9}, {
  3.608763371455811*^9, 3.6087633726135263`*^9}}],

Cell[BoxData["0.2`"], "Output",
 CellChangeTimes->{3.6087630951431007`*^9, 3.608763373043088*^9, 
  3.608765228716998*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"NoisyVoltage", ":=", 
  RowBox[{"RandomVariate", "[", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"TrueVoltage", " ", ",", " ", "NoiseLevel"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.608763182928393*^9, 3.608763185542733*^9}, {
  3.6087632596583557`*^9, 3.608763435485209*^9}}],

Cell[TextData[{
 StyleBox["A",
  FontWeight->"Bold"],
 " is the state transition matrix. Multiply the previous state by ",
 StyleBox["A",
  FontWeight->"Bold"],
 " to obtain the new state."
}], "Text",
 CellChangeTimes->{{3.608763861089134*^9, 3.6087639283348293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"{", 
   RowBox[{"{", "1", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608763498810025*^9, 3.608763539118225*^9}, {
  3.608763605079578*^9, 3.608763631938225*^9}, {3.6087638966968937`*^9, 
  3.608763897080432*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.608763606712923*^9, 3.608763633897285*^9}, 
   3.6087651978327703`*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["B",
  FontWeight->"Bold"],
 " is the control matrix. Multiply any control factors by ",
 StyleBox["B",
  FontWeight->"Bold"],
 "; in this case, there are no control factors, so we could have let ",
 StyleBox["B",
  FontWeight->"Bold"],
 " be anything."
}], "Text",
 CellChangeTimes->{{3.608763939254293*^9, 3.608763946973133*^9}, {
  3.608763984142095*^9, 3.608764024818247*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"{", 
   RowBox[{"{", "0", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608763622138216*^9, 3.608763632889873*^9}, {
  3.608763935639477*^9, 3.608763936039485*^9}, {3.6087639820634003`*^9, 
  3.608763982262024*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.608763635232307*^9, 3.608763982564618*^9, 
  3.608765200842895*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["H",
  FontWeight->"Bold"],
 " is the observation matrix. Multiply an incoming observation by ",
 StyleBox["H",
  FontWeight->"Bold"],
 " to obtain a state. In this case, we don\[CloseCurlyQuote]t modify the \
observations beforehand."
}], "Text",
 CellChangeTimes->{{3.608764057656898*^9, 3.608764068791223*^9}, {
  3.608764099455215*^9, 3.608764127501954*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{"{", 
   RowBox[{"{", "1", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6087640483726463`*^9, 3.608764051013399*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.608764051514361*^9, 3.60876519908982*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Q",
  FontWeight->"Bold"],
 " is the process covariance; very small in this case."
}], "Text",
 CellChangeTimes->{{3.60876414134354*^9, 3.608764148101156*^9}},
 FontWeight->"Plain"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", "=", 
  RowBox[{"{", 
   RowBox[{"{", "0.0001", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608763664160527*^9, 3.608763685605988*^9}, {
  3.608763720297989*^9, 3.608763758182475*^9}, {3.608764151079288*^9, 
  3.608764151358824*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0.0001`", "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6087636860249863`*^9, {3.608763728715158*^9, 3.6087637585910997`*^9}, 
   3.608765202246249*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["R",
  FontWeight->"Bold"],
 " is the measurement covariance; also very small."
}], "Text",
 CellChangeTimes->{{3.608764157421604*^9, 3.608764164396597*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "=", 
  RowBox[{"{", 
   RowBox[{"{", "0.1", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608763738950509*^9, 3.608763764526615*^9}, {
  3.608764194021982*^9, 3.608764194300762*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0.1`", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.608763764975016*^9, 3.608765204097134*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["X0",
  FontWeight->"Bold"],
 " is the initial prediction for the state; we will set it to a vastly \
incorrect value."
}], "Text",
 CellChangeTimes->{{3.608764173772923*^9, 3.608764191419656*^9}, {
  3.608764241299479*^9, 3.6087642424254723`*^9}},
 FontWeight->"Plain"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X0", "=", 
  RowBox[{"{", 
   RowBox[{"{", "7", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608763773173401*^9, 3.608763783564557*^9}, {
   3.608763822381255*^9, 3.6087638468118687`*^9}, 3.60876419711758*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "7", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.608763847282084*^9, 3.608765205502108*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["P0 ",
  FontWeight->"Bold"],
 "is the initial prediction for the covariance."
}], "Text",
 CellChangeTimes->{{3.608764206989533*^9, 3.6087642437935667`*^9}, 
   3.6087643252484703`*^9},
 FontWeight->"Plain"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P0", "=", 
  RowBox[{"{", 
   RowBox[{"{", "1", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.608764248595645*^9, 3.608764250077484*^9}, 
   3.6087643276086597`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.608764253171286*^9, 3.608764327881624*^9, 
  3.60876520693513*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"KalmanStep", "[", 
   RowBox[{"A_", ",", "B_", ",", "H_", ",", "Q_", ",", "R_", ",", 
    RowBox[{"{", 
     RowBox[{"X_", ",", "P_"}], "}"}], ",", "NewMeasurement_", ",", 
    "NewControl_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Prediction", " ", 
     RowBox[{"step", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictedStateEstimate", "=", 
     RowBox[{
      RowBox[{"A", ".", "X"}], " ", "+", " ", 
      RowBox[{"B", ".", "NewControl"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"predictedProbEstimate", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"A", ".", "P"}], ")"}], ".", 
       RowBox[{"Transpose", "[", "A", "]"}]}], "+", "Q"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Observation", " ", 
      RowBox[{"step", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"innovation", " ", "=", " ", 
     RowBox[{"NewMeasurement", "-", 
      RowBox[{"H", ".", "predictedStateEstimate"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"innovationCovariance", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"H", ".", "predictedProbEstimate"}], ")"}], ".", 
       RowBox[{"Transpose", "[", "H", "]"}]}], "+", "R"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Update", " ", 
      RowBox[{"step", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"kalmanGain", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"predictedProbEstimate", ".", 
        RowBox[{"Transpose", "[", "H", "]"}]}], ")"}], ".", 
      RowBox[{"Inverse", "[", "innovationCovariance", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"newStateEstimate", "=", 
     RowBox[{"predictedStateEstimate", "+", 
      RowBox[{"kalmanGain", ".", "innovation"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"size", "=", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "P", "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"newProbEstimate", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "size", "]"}], "-", 
        RowBox[{"kalmanGain", ".", "H"}]}], ")"}], ".", 
      "predictedProbEstimate"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"newStateEstimate", ",", "newProbEstimate"}], "}"}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.608764288479827*^9, 3.608764303777726*^9}, {
  3.608764461689041*^9, 3.608764487200529*^9}, {3.6087645317642097`*^9, 
  3.608764586810583*^9}, {3.6087646403020678`*^9, 3.6087648571965113`*^9}, {
  3.608764951218495*^9, 3.608765028920925*^9}, {3.608765081201311*^9, 
  3.6087651190406027`*^9}, {3.608765286406704*^9, 3.608765294540155*^9}, {
  3.60876617102805*^9, 3.608766173083828*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KalmanVoltageMapping", "[", 
   RowBox[{"OldStateProb_", ",", "NewMeasurement_"}], "]"}], ":=", 
  RowBox[{"KalmanStep", "[", 
   RowBox[{
   "A", ",", "B", ",", "H", ",", "Q", ",", "R", ",", "OldStateProb", ",", 
    RowBox[{"{", 
     RowBox[{"{", "NewMeasurement", "}"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6087661311232443`*^9, 3.608766141080113*^9}, {
  3.6087662351821117`*^9, 3.6087663023866*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumSamples", "=", "100"}]], "Input",
 CellChangeTimes->{{3.608766814435089*^9, 3.608766816261595*^9}}],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{3.608766816523362*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NoisySamples", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "NoisyVoltage", ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "NumSamples", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.608765966141684*^9, 3.608766005541418*^9}, {
  3.6087668192302637`*^9, 3.608766821630859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.9713774614988084`", ",", "2.93479975123403`", ",", "2.8989204038014136`",
    ",", "3.0022687889207686`", ",", "2.8265621103955545`", ",", 
   "2.791573724495371`", ",", "3.055892309659727`", ",", 
   "2.8043227808329374`", ",", "2.767324068797213`", ",", 
   "3.0626390325837023`", ",", "3.377691507522802`", ",", 
   "3.1936226118187605`", ",", "3.2952142814746908`", ",", 
   "2.6982969681240667`", ",", "2.962830522654258`", ",", 
   "3.0830940877701525`", ",", "2.7964444268655715`", ",", 
   "3.06966750171222`", ",", "2.969431146974574`", ",", "2.9175600671038504`",
    ",", "3.0710341780411805`", ",", "2.9903677690829715`", ",", 
   "3.164220325165253`", ",", "2.935836391866451`", ",", 
   "3.0250134606862056`", ",", "3.6288449964806215`", ",", 
   "3.2918627021987303`", ",", "2.8404806931739044`", ",", 
   "2.7892885229593762`", ",", "3.1544125869960165`", ",", 
   "2.8638136333872697`", ",", "2.955224097321562`", ",", 
   "3.1066816205099825`", ",", "2.6640566933926184`", ",", 
   "2.9388529682969833`", ",", "3.143957604896022`", ",", 
   "3.106879935473393`", ",", "3.079202146795023`", ",", 
   "2.8875014202267275`", ",", "3.0798515442916665`", ",", 
   "2.940456662516578`", ",", "3.161226294121113`", ",", "2.980408942277754`",
    ",", "3.0467100319166716`", ",", "3.020619412608429`", ",", 
   "2.70639569980655`", ",", "3.034946028538228`", ",", "3.017551713900148`", 
   ",", "3.2778982465470357`", ",", "3.2017302271647328`", ",", 
   "2.960939311665948`", ",", "3.0025704853976496`", ",", "2.94174656649802`",
    ",", "2.817986914780598`", ",", "3.142071346724014`", ",", 
   "2.992606172271474`", ",", "2.705931139982309`", ",", 
   "3.1762271171618157`", ",", "2.8116279925578738`", ",", 
   "2.977400135903798`", ",", "3.0711233693143374`", ",", 
   "3.147328287354715`", ",", "2.5596400969604596`", ",", 
   "2.837802831517029`", ",", "2.764944570920814`", ",", "3.323690699670192`",
    ",", "3.1144959661713085`", ",", "3.095082126835188`", ",", 
   "2.9544684605237292`", ",", "2.9530112301874314`", ",", 
   "3.0289893091695146`", ",", "3.2324816093900495`", ",", 
   "2.9825704326864475`", ",", "3.1130757021054705`", ",", 
   "2.8084212597170723`", ",", "3.0762454264984784`", ",", 
   "3.0079048646211892`", ",", "2.727646320470343`", ",", 
   "3.0747563099323365`", ",", "2.9517350473938473`", ",", 
   "3.2314225928247318`", ",", "3.160195285860813`", ",", 
   "3.073282181062922`", ",", "2.929806360756058`", ",", 
   "3.1561388409332904`", ",", "3.1572080492396353`", ",", 
   "3.06436756217381`", ",", "2.712866732855632`", ",", "2.9687226471038195`",
    ",", "2.940718368243733`", ",", "2.7884333567035395`", ",", 
   "2.929553016684823`", ",", "3.0266847237025782`", ",", "2.98980501273242`",
    ",", "3.0961091257134252`", ",", "3.0794797978251096`", ",", 
   "2.9786837133741515`", ",", "3.0029345142120207`", ",", 
   "3.2820109823637496`", ",", "3.2197347281678392`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6087659786695642`*^9, 3.608766005891382*^9}, 
   3.608766822001009*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KalmanData", "=", 
  RowBox[{"FoldList", "[", 
   RowBox[{"KalmanVoltageMapping", ",", 
    RowBox[{"{", 
     RowBox[{"X0", ",", "P0"}], "}"}], ",", "NoisySamples"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6087660333964233`*^9, 3.6087660346167727`*^9}, {
  3.6087663446035767`*^9, 3.608766402925543*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "7", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.33758258271517`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.09090991728024732`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.14566986584184`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.04764669739462728`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0659288489251413`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.03231659200279597`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.050344380537738`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0244807629561343`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.006190381110977`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.01973078537397411`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.970673490841573`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.016548990572068076`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.982836539180938`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.014272725799356144`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9604034872254448`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.012566567508909589`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9386964844989367`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.011242525434981346`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9513225812992`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.010187056015362999`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9910922622186127`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.009327527986539064`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.008540893053203`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.008615316602691386`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.031522469336427`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.008016640961955885`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.006506230128068`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.007507300346865169`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0034185750754454`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.007069502089861496`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0087487645755937`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.006689871605309762`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.995250113695769`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.00635816066003413`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9997645581003187`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.006066383845065447`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.998002724932821`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.005808226315840612`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.993515128034692`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.005578628328852415`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9976806048236484`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.005373487921494941`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9973011092851274`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.005189444313787098`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.005686659261701`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.005023717570417905`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.002282165484056`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004873988181578287`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.003359243678817`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0047383054295075016`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0322255163781158`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004615016820126631`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0439162340559576`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004502713138294017`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.034964693424542`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004400185234400971`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0243849200749384`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004306389720082076`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.029872635686822`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004220421500921345`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.022995316043801`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004141491607070613`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0202377667131097`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004068909166283378`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.023697307350973`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.004002066643156075`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0095259290718106`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003940427673945467`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.00678133264042`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003883516979195674`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0120364348484197`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0038309119511630574`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.01562363949329`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003782235599943726`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0179996640658513`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003737150608593399`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0131772916025006`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003695354298633694`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0156152852223688`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003656574346973113`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0128941183393314`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0036205651262258575`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0182149485877905`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0035871045647485663`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.016870570238855`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0035559914419696355`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.017923020898093`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003527043049910329`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.018017397120023`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0035000931640628025`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0071885734384143`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0034749902766608868`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0081466486631534`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0034515960533635297`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.008469222084041`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003429783980860397`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.017655238107258`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0034094381782086495`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.023896212897783`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0033904523490568754`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0217728473234127`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003372728855493001`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.021128381896717`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003356177897214746`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.018476460267693`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.00334071678218048`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.011807638112663`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0033262692769480164`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.016122968693922`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0033127650266233416`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.01534688171522`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003300139035780287`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0051722673330583`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003288331202923927`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0107782238113447`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003277285902094241`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.004272082132909`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.00326695160607406`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0033967874559484`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003257280546402619`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.005596701526302`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0032482284060244364`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.010188456305467`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003239754040940347`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9956275477981236`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003231819227687758`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9905386659005635`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0032243884338726487`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9832803369477565`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0032174286093164237`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9942106039066205`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0032109089956747936`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.998065510342366`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0032048009526403527`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0011691473819884`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031990777990612697`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9996776606959727`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031937146675004003`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9981896136532207`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031886883709263203`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9991702689608837`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003183977280373733`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0065885458456227`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031795612125383966`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0058258695581714`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003175421326383646`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.009227340927301`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003171540027933905`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0028660033084944`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031679008825170867`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0051880867415055`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003164488533794078`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0052739719316905`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031612886289808617`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.996505691825728`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031582877497284712`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9989748692248672`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031554733481788137`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.99748547620814`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.00315283368776134`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0048553323812826`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003150357788337291`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0097454890688478`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003148035375335462`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0117442624351236`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003145856832556615`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0091682879004584`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031438131583533873`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.013785949717028`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031418959249190927`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0182895431063224`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003140097240442684`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.019735660132713`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031384097139085477`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0101097145399374`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003136826422339069`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0088120888954575`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031353408802952732`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0066780677720963`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003133947011466505`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.999841248571043`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003132639122194273`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9976402345297735`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.00313141187678818`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9985494026362822`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031302602745034917`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "2.9982757749688123`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031291796280604003`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.001336164136949`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003128165543594637`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0037798827131246`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031272139019377803`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.002995295940754`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031263208411335406`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.0029933962183133`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.003125482740103548`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.01171184813937`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031246962033827656`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "3.01821039563931`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.0031239580468507004`", "}"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.60876637749445*^9, 3.6087664032994947`*^9}, 
   3.6087668241790457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KalmanSamples", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Extract", "[", 
       RowBox[{
        RowBox[{"First", "[", "#", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ")"}], "&"}], ",", 
    "KalmanData"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6087664125497*^9, 3.608766441517638*^9}, {
  3.608766491805358*^9, 3.608766549400754*^9}, {3.608766692123548*^9, 
  3.6087667178575163`*^9}, {3.608766867949903*^9, 3.608766869381051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7", ",", "3.33758258271517`", ",", "3.14566986584184`", ",", 
   "3.0659288489251413`", ",", "3.050344380537738`", ",", 
   "3.006190381110977`", ",", "2.970673490841573`", ",", "2.982836539180938`",
    ",", "2.9604034872254448`", ",", "2.9386964844989367`", ",", 
   "2.9513225812992`", ",", "2.9910922622186127`", ",", "3.008540893053203`", 
   ",", "3.031522469336427`", ",", "3.006506230128068`", ",", 
   "3.0034185750754454`", ",", "3.0087487645755937`", ",", 
   "2.995250113695769`", ",", "2.9997645581003187`", ",", 
   "2.998002724932821`", ",", "2.993515128034692`", ",", 
   "2.9976806048236484`", ",", "2.9973011092851274`", ",", 
   "3.005686659261701`", ",", "3.002282165484056`", ",", "3.003359243678817`",
    ",", "3.0322255163781158`", ",", "3.0439162340559576`", ",", 
   "3.034964693424542`", ",", "3.0243849200749384`", ",", 
   "3.029872635686822`", ",", "3.022995316043801`", ",", 
   "3.0202377667131097`", ",", "3.023697307350973`", ",", 
   "3.0095259290718106`", ",", "3.00678133264042`", ",", 
   "3.0120364348484197`", ",", "3.01562363949329`", ",", 
   "3.0179996640658513`", ",", "3.0131772916025006`", ",", 
   "3.0156152852223688`", ",", "3.0128941183393314`", ",", 
   "3.0182149485877905`", ",", "3.016870570238855`", ",", 
   "3.017923020898093`", ",", "3.018017397120023`", ",", 
   "3.0071885734384143`", ",", "3.0081466486631534`", ",", 
   "3.008469222084041`", ",", "3.017655238107258`", ",", "3.023896212897783`",
    ",", "3.0217728473234127`", ",", "3.021128381896717`", ",", 
   "3.018476460267693`", ",", "3.011807638112663`", ",", "3.016122968693922`",
    ",", "3.01534688171522`", ",", "3.0051722673330583`", ",", 
   "3.0107782238113447`", ",", "3.004272082132909`", ",", 
   "3.0033967874559484`", ",", "3.005596701526302`", ",", 
   "3.010188456305467`", ",", "2.9956275477981236`", ",", 
   "2.9905386659005635`", ",", "2.9832803369477565`", ",", 
   "2.9942106039066205`", ",", "2.998065510342366`", ",", 
   "3.0011691473819884`", ",", "2.9996776606959727`", ",", 
   "2.9981896136532207`", ",", "2.9991702689608837`", ",", 
   "3.0065885458456227`", ",", "3.0058258695581714`", ",", 
   "3.009227340927301`", ",", "3.0028660033084944`", ",", 
   "3.0051880867415055`", ",", "3.0052739719316905`", ",", 
   "2.996505691825728`", ",", "2.9989748692248672`", ",", "2.99748547620814`",
    ",", "3.0048553323812826`", ",", "3.0097454890688478`", ",", 
   "3.0117442624351236`", ",", "3.0091682879004584`", ",", 
   "3.013785949717028`", ",", "3.0182895431063224`", ",", 
   "3.019735660132713`", ",", "3.0101097145399374`", ",", 
   "3.0088120888954575`", ",", "3.0066780677720963`", ",", 
   "2.999841248571043`", ",", "2.9976402345297735`", ",", 
   "2.9985494026362822`", ",", "2.9982757749688123`", ",", 
   "3.001336164136949`", ",", "3.0037798827131246`", ",", 
   "3.002995295940754`", ",", "3.0029933962183133`", ",", "3.01171184813937`",
    ",", "3.01821039563931`"}], "}"}]], "Output",
 CellChangeTimes->{{3.608766521986499*^9, 3.608766549825148*^9}, {
   3.608766709800406*^9, 3.608766718264903*^9}, 3.608766827028543*^9, 
   3.608766869701807*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrueSamples", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "TrueVoltage", ")"}], "&"}], ",", 
    RowBox[{"Range", "[", "NumSamples", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.608766877317855*^9, 3.608766909220154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", "3.`", ",", 
   "3.`", ",", "3.`", ",", "3.`", ",", "3.`"}], "}"}]], "Output",
 CellChangeTimes->{3.6087669096739283`*^9}]
}, Open  ]],

Cell[TextData[{
 "In the graph below, ",
 StyleBox["red",
  FontWeight->"Bold"],
 " is the noisy sampling, ",
 StyleBox["blue",
  FontWeight->"Bold"],
 " is the Kalman-filtered data, and ",
 StyleBox["green",
  FontWeight->"Bold"],
 " is the ideal (true) data. Note that the blue (Kalman) line starts way up \
high since we gave a bad initial prediction."
}], "Text",
 CellChangeTimes->{{3.608767124210266*^9, 3.60876716419068*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"KalmanSamples", ",", "NoisySamples", ",", "TrueSamples"}], "}"}],
    ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608766764347418*^9, 3.608766767520912*^9}, {
  3.608766872683659*^9, 3.608766874292759*^9}, {3.608766944523047*^9, 
  3.608766982727271*^9}, {3.608767035535408*^9, 3.608767109458396*^9}},
 NumberMarks->False],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.24720000000000014`, 0.24, 0.6], LineBox[CompressedData["
1:eJw9lAtMU1cYx69ALU+FUh1D5sZjs4DjsQ1wdMKf0lKgQOkDWuYyBhNwopCB
Eo0oN0zxsQFDR0qEqMlwS1iFPYhhkWFRFLaMbboNgqMjBCGMlaWYDqpWmdv6
3Zvc3PzyO9/5zvnOd09wcaW6xIVhmJIn779f2cbv4sI3PUpm/nt88f+Xgbkn
te7Nrzyd7I7ivRXL2ggP0LhOu7KXd9zdyUIUnym0BZYRB8C/cObUJW/iIIz7
na6xXuc7+TnUD6WXTUwSh2Bl2G3tfDdxGOT6iuzqeuIX8L3LfldlB7EIh4qM
w4OLxBHo7ZfMHPajfFvxR1DCnSYQR6FoeU+oxoc4BrzoIhXDJ46FejJ7aoGL
fwn+Sp8vZMs0/8sQLh5rPrpK/ApESfI78w+J4+BlSVjfd484Ho0t3vZkzicg
bgtvzcEHxNvQUF5bddGL8r2KX5Z83zO6ESci9E+f+Om1xGK0NRiqV1OIX0Oq
TDRoLSDejpToyy3tcuIkSOda+qyxxMm41ZxpfnE7MaC3CSIDop3MApLdfuVV
4eRT4Npuij8RQz4FZ881aev9yUvwmXJ94QzVk5WgKs3a9EkA+VTs0ZdkrD5L
PhVfu7q5mMPIS7FjMvRLRyB5KaQjgfMPaDwjw+YLUvEuzsuwNOk6nf08+TR0
NbR7NIaQT0P77bCfe7n55fj2mU05c8SsHNLWx9N968inQ99pjOnxJZ+OFceA
Us+dfwaMMff2irj4DLy9pazOSvVgMiFofjrJsJV8JiRBu3fIIskrcO36UccY
rZdVoFHxxtkorj5ZmPFIFPKCyWdhrq4tuoLbfzaUefZBgyf5bAwlXr4r2Eg+
B62FotGr7uRzECsPmLVx/aLETMSH6TXUX6wSBv7+HrOQfC5CVaVnvFac/Yhc
RF4RnzxvcTKbiyOWH4XXzE425SLRsuvzMBv1rwq22tgbHg6KV6FTlGPf6UL5
VPCdKGB09L+YVGgbXjeWSeMZNY59VPww6zHFqxF16FPFEa6f1FgcuV/xF63f
pEZkQP/IrIDWr8HB8eqO33lOhgYtfgk+F7h6adB15bhwlNikwfjrs/fH7ZRf
izU3007OPaL8WiTv1HZN0P/JasEquw1LHhSvRZ2x9N2/uf7Pw+m2bW/50Hki
D7dO3bh9k9bH5qGmYuIHcRDF52GWsTj2cf2bD353TWS5iOLzIWlZKO2l82Hz
8Y7lA4E3zWfKh716g/gSd3/pUFs5MGSk+kIHxa8fj0bQfcPqYA/cfIBP+zPp
sM+z0uUAV3893g9fONFP5wU9ujfIrn5D9yGrx8JvP5WEUD+Z9Oi4O1YazPVX
AaamLhY5nqL4ArQOLB5WPNnfP5gghrk=
      "]]}, 
    {RGBColor[0.6, 0.24, 0.4428931686004542], LineBox[CompressedData["
1:eJw9UwlQlGUYXjlWiA5CJiUIOTYOCwfkWu5nOZdj2YNddkWRyWKm0sJyRnIV
W6EBRMLs4AqmCYEUwwE5BCR2JVBCGLkElJ00jhDIhGCQHBir6Xv9Z/755/mf
73mf532/77PfnyZLNeBwOO/8+/73/f9ZDOm9OHf6re7NYD/wwb2OmE/UhE1g
GImdG+6EzTHaVv9plZEJw5aY2JpZ3FfGZXgb/qwcL+UpCNvAsH6gJv1jWm+H
U2P8HqQR74ADSud+tSNhHpI9z00LNbTeCXlxXLssYzOGXVDHf94wL9+U4R2o
fWwfX7L3OYbfhPVcTotNoTHDO8Gx88y430D53XGj6WKAWw3V90Cj7rDANoX8
dyH7m5u3awuI94TT6NPXUq+R3guTZZlXXZWEvSG+tJ6sPkvrffBh751HEX8Q
74uB/Y86ZBLKy0d/T2xv0XHi/eA9oRf4e5LeH2VW9ZP3Nr/AcAC4D6/btCuo
v0Bk3zJfErVS3iCMaKM1RySEg6F9UFITGEh+IZidid6+dY54wP6GRW5cJfPX
AA2prdPH7pK/APKM6pV1MZufRoDkRrmqO5PyhqJWfD542InV14Si4AfrX6ee
6cNQ/NKudq8KhjVhMODzVaVWpA/HEd5dr1PniA/Htqxs3ovZxEfAzWzawCOG
6kfgkrij8v4Y8ZHYPbgn80IK6SNhktOc6b+D/KPgUDHzy+Vqyh+FjS8/7zkb
RbwQk5+5Ov/lSHoh+MLwKw5+NN9o8OI623nl5B8Nr30uy5w68o/Byk9NP4YZ
kz4GX90+efByLvGxeFkc2Bp4ms1bE4ub3BTRqgPtRxwam4JOTizS/OPQVn7V
T1tF51WE37hRP8+9S/4icNJ4gz4naP/ika8pdL0ySPp4dGWY2l94dv7EqGl+
erjNjfRiNPWLC3lqI8ZLYDZTsDbYwOpBgnR9Uui3tpRXgtIhodNCIZuHToL3
Rj/SH5+n+lLU55geaOtkGFK8/Sp/r66C8kiRs2lLUtd3DOukKMn10e4LIL0M
GsP3pdv1LB9kcAnaMiXSk14Gz+0jAV/PsvU6GZY2ab+oSqf+E5AXPH/GqYz8
E7Dku3bQ3Zz2IwFZfQsB/CE2T10Cxr+3GLUqIX85hqxbwpzLmR/kePB7+Ssr
d2hecsyvitIthQzr5NDtGX9sWUh6BZ6o+dLgQ6RXYDX/WEt3COkVqPP1iF0V
kF6Botplx+Es0iei8g0cXW5g+ZCI7spr55e01H8iioctkoroPugSYbo48Hpz
PPWvRPfRlYzWNPJXom9sXV3tQ/0rwRtam7JdIL0SKTEn9CNd5K/C8q1J0XW6
n1Bho+CQnWqE/FV4eGYkx4BL81ehf0H2d4GA7sduzHo/iTLqNMU/8L6dzw==

      "]]}, 
    {RGBColor[0.6, 0.5470136627990908, 0.24], LineBox[CompressedData["
1:eJxdyzlKBFEYhdGLkaGBgYGBioiISDvPdtnOs7ZzKhq7hbe0tySXoNIi1Cko
fs77uJNvn/2PoSTvP//vHXxf3cEdbv4emra9I3gUj+FxPIGn8DSewbN4Ds/j
BdzBi3gJL+MVvIrX8DrewJt4C2/jHbyL93AXN20XnH06To+Oc0DHOaTjHNFx
juk4J3ScUzrOGR3nnI5zQce5pONc0XGu6Tg3dJzbthtccMW5Y48Lrjh99rjg
inPPHhdccR7Y44IrziN7XHDFeWKPC644z+xxwRXnhT0uuOK8/vsb/ftnyg==

      "]]}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 2},
  Method->{},
  PlotRange->{{0, 101.}, {2, 4}},
  PlotRangeClipping->True,
  PlotRangePadding->{{2.02, 2.02}, {0., 0.}}]], "Output",
 CellChangeTimes->{
  3.6087667338663807`*^9, 3.6087667681356173`*^9, 3.608766830248426*^9, 
   3.608766874593219*^9, 3.608766952809651*^9, 3.6087669832616034`*^9, {
   3.608767046974184*^9, 3.608767109976592*^9}}]
}, Open  ]]
},
WindowSize->{619, 652},
WindowMargins->{{51, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 20, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 186, 3, 28, "Input"],
Cell[768, 27, 121, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[926, 34, 176, 3, 28, "Input"],
Cell[1105, 39, 122, 2, 28, "Output"]
}, Open  ]],
Cell[1242, 44, 322, 7, 46, "Input"],
Cell[1567, 53, 269, 8, 49, "Text"],
Cell[CellGroupData[{
Cell[1861, 65, 262, 6, 28, "Input"],
Cell[2126, 73, 167, 4, 28, "Output"]
}, Open  ]],
Cell[2308, 80, 406, 12, 49, "Text"],
Cell[CellGroupData[{
Cell[2739, 96, 262, 6, 28, "Input"],
Cell[3004, 104, 162, 4, 28, "Output"]
}, Open  ]],
Cell[3181, 111, 388, 10, 49, "Text"],
Cell[CellGroupData[{
Cell[3594, 125, 164, 4, 28, "Input"],
Cell[3761, 131, 136, 3, 28, "Output"]
}, Open  ]],
Cell[3912, 137, 208, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[4145, 147, 265, 6, 28, "Input"],
Cell[4413, 155, 200, 5, 28, "Output"]
}, Open  ]],
Cell[4628, 163, 183, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[4836, 172, 213, 5, 28, "Input"],
Cell[5052, 179, 140, 3, 28, "Output"]
}, Open  ]],
Cell[5207, 185, 296, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[5528, 197, 236, 5, 28, "Input"],
Cell[5767, 204, 137, 3, 28, "Output"]
}, Open  ]],
Cell[5919, 210, 234, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[6178, 221, 191, 5, 28, "Input"],
Cell[6372, 228, 161, 4, 28, "Output"]
}, Open  ]],
Cell[6548, 235, 2920, 70, 335, "Input"],
Cell[9471, 307, 515, 12, 63, "Input"],
Cell[CellGroupData[{
Cell[10011, 323, 126, 2, 28, "Input"],
Cell[10140, 327, 72, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10249, 333, 331, 8, 28, "Input"],
Cell[10583, 343, 3082, 50, 267, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13702, 398, 335, 8, 46, "Input"],
Cell[14040, 408, 20583, 611, 879, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34660, 1024, 548, 14, 28, "Input"],
Cell[35211, 1040, 3157, 52, 267, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38405, 1097, 278, 7, 28, "Input"],
Cell[38686, 1106, 1364, 20, 131, "Output"]
}, Open  ]],
Cell[40065, 1129, 432, 13, 68, "Text"],
Cell[CellGroupData[{
Cell[40522, 1146, 504, 12, 46, "Input"],
Cell[41029, 1160, 3863, 72, 250, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
